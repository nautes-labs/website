<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Register Runtime Cluster | Nautes</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="Kubernetes-native all-in-one Internal Developer Platform">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.c2c28341.css" as="style"><link rel="preload" href="/assets/js/app.fc750a70.js" as="script"><link rel="preload" href="/assets/js/2.5cda13a8.js" as="script"><link rel="preload" href="/assets/js/38.cccd8d80.js" as="script"><link rel="prefetch" href="/assets/js/10.954f943b.js"><link rel="prefetch" href="/assets/js/11.9cd35a8a.js"><link rel="prefetch" href="/assets/js/12.debc7c72.js"><link rel="prefetch" href="/assets/js/13.dee35591.js"><link rel="prefetch" href="/assets/js/14.2a696c45.js"><link rel="prefetch" href="/assets/js/15.e37f3143.js"><link rel="prefetch" href="/assets/js/16.69ba4994.js"><link rel="prefetch" href="/assets/js/17.e9bfa8b1.js"><link rel="prefetch" href="/assets/js/18.9fd6e6d1.js"><link rel="prefetch" href="/assets/js/19.b4c42f8a.js"><link rel="prefetch" href="/assets/js/20.fecb0727.js"><link rel="prefetch" href="/assets/js/21.b2de65cb.js"><link rel="prefetch" href="/assets/js/22.305f3553.js"><link rel="prefetch" href="/assets/js/23.4e425205.js"><link rel="prefetch" href="/assets/js/24.6ac4a85f.js"><link rel="prefetch" href="/assets/js/25.76d4b3d3.js"><link rel="prefetch" href="/assets/js/26.f374973e.js"><link rel="prefetch" href="/assets/js/27.4c801238.js"><link rel="prefetch" href="/assets/js/28.773104f6.js"><link rel="prefetch" href="/assets/js/29.c3fd851b.js"><link rel="prefetch" href="/assets/js/3.bdfef2d9.js"><link rel="prefetch" href="/assets/js/30.973bc71d.js"><link rel="prefetch" href="/assets/js/31.b5842936.js"><link rel="prefetch" href="/assets/js/32.72b46c58.js"><link rel="prefetch" href="/assets/js/33.01d5cbc4.js"><link rel="prefetch" href="/assets/js/34.0dbcbadb.js"><link rel="prefetch" href="/assets/js/35.0d4a5e3c.js"><link rel="prefetch" href="/assets/js/36.a0574e4c.js"><link rel="prefetch" href="/assets/js/37.3fe72c83.js"><link rel="prefetch" href="/assets/js/39.f9720bdc.js"><link rel="prefetch" href="/assets/js/4.18760c5a.js"><link rel="prefetch" href="/assets/js/40.3f1e8c84.js"><link rel="prefetch" href="/assets/js/41.cfda4e79.js"><link rel="prefetch" href="/assets/js/42.8dd3c223.js"><link rel="prefetch" href="/assets/js/43.c3a48afd.js"><link rel="prefetch" href="/assets/js/44.682d9710.js"><link rel="prefetch" href="/assets/js/45.96e09193.js"><link rel="prefetch" href="/assets/js/46.2dadb2ac.js"><link rel="prefetch" href="/assets/js/47.adbdeadd.js"><link rel="prefetch" href="/assets/js/48.fed11ce4.js"><link rel="prefetch" href="/assets/js/49.33b480fc.js"><link rel="prefetch" href="/assets/js/5.0a76c1bf.js"><link rel="prefetch" href="/assets/js/50.12715226.js"><link rel="prefetch" href="/assets/js/51.d6a261ff.js"><link rel="prefetch" href="/assets/js/52.2c32dd2b.js"><link rel="prefetch" href="/assets/js/53.444d4f5d.js"><link rel="prefetch" href="/assets/js/54.378deaa6.js"><link rel="prefetch" href="/assets/js/55.fc479b8e.js"><link rel="prefetch" href="/assets/js/56.b3d4010b.js"><link rel="prefetch" href="/assets/js/57.8de06c78.js"><link rel="prefetch" href="/assets/js/58.0cf26d90.js"><link rel="prefetch" href="/assets/js/59.2ea683d6.js"><link rel="prefetch" href="/assets/js/6.08b03b29.js"><link rel="prefetch" href="/assets/js/60.5faf93c2.js"><link rel="prefetch" href="/assets/js/61.d657ae56.js"><link rel="prefetch" href="/assets/js/7.57051b0f.js"><link rel="prefetch" href="/assets/js/8.d80c16bd.js"><link rel="prefetch" href="/assets/js/9.568b32c0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c2c28341.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/en/" class="home-link router-link-active"><!----> <span class="site-name">Nautes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/en/guide/user-guide/introduction.html" class="nav-link">
  Document
</a></div><div class="nav-item"><a href="/en/api/introduction.html" class="nav-link">
  API
</a></div><div class="nav-item"><a href="https://github.com/nautes-labs/nautes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/guide/user-guide/cluster.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/guide/user-guide/cluster.html" class="nav-link">
  中文
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/en/guide/user-guide/introduction.html" class="nav-link">
  Document
</a></div><div class="nav-item"><a href="/en/api/introduction.html" class="nav-link">
  API
</a></div><div class="nav-item"><a href="https://github.com/nautes-labs/nautes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/guide/user-guide/cluster.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/guide/user-guide/cluster.html" class="nav-link">
  中文
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Getting Started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/en/guide/user-guide/introduction.html" class="sidebar-link">Overview</a></li><li><a href="/en/guide/user-guide/installation.html" class="sidebar-link">Installation</a></li><li><a href="/en/guide/user-guide/run-a-pipeline.html" class="sidebar-link">Run a Pipeline</a></li><li><a href="/en/guide/user-guide/deploy-an-application.html" class="sidebar-link">Deploy an Application</a></li><li><a href="/en/guide/user-guide/clean-environment.html" class="sidebar-link">Clean Up the Environment</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>User Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/en/guide/user-guide/main-process.html" class="sidebar-link">Main Process</a></li><li><a href="/en/guide/user-guide/cluster.html" aria-current="page" class="active sidebar-link">Register Runtime Cluster</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/guide/user-guide/cluster.html#prerequisites" class="sidebar-link">Prerequisites</a></li><li class="sidebar-sub-header"><a href="/en/guide/user-guide/cluster.html#register-physical-cluster-api" class="sidebar-link">Register Physical Cluster（API）</a></li><li class="sidebar-sub-header"><a href="/en/guide/user-guide/cluster.html#register-virtual-cluster-api" class="sidebar-link">Register Virtual Cluster（API）</a></li><li class="sidebar-sub-header"><a href="/en/guide/user-guide/cluster.html#delete-physical-cluster-api" class="sidebar-link">Delete Physical Cluster（API）</a></li><li class="sidebar-sub-header"><a href="/en/guide/user-guide/cluster.html#delete-virtual-cluster-api" class="sidebar-link">Delete Virtual Cluster（API）</a></li></ul></li><li><a href="/en/guide/user-guide/product.html" class="sidebar-link">Maintain Product</a></li><li><a href="/en/guide/user-guide/project.html" class="sidebar-link">Maintain Project</a></li><li><a href="/en/guide/user-guide/code-repo.html" class="sidebar-link">Maintain Code Repository and its Authorization</a></li><li><a href="/en/guide/user-guide/environment.html" class="sidebar-link">Maintain Environment</a></li><li><a href="/en/guide/user-guide/project-pipeline-runtime.html" class="sidebar-link">Maintain Pipeline-Runtime</a></li><li><a href="/en/guide/user-guide/deployment-runtime.html" class="sidebar-link">Maintain Deployment-Runtime</a></li><li><a href="/en/guide/user-guide/deployment-results.html" class="sidebar-link">View Pipeline and Deployment Results</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="register-runtime-cluster"><a href="#register-runtime-cluster" class="header-anchor">#</a> Register Runtime Cluster</h1> <p>Before starting this section, please ensure that you have read the <a href="/en/guide/user-guide/main-process.html">Main Process</a> section to understand the main process and related terminology for running pipelines and deploying applications in Nautes.</p> <p>Runtime clusters are used to host the runtime environment for applications. The supported cluster types include physical clusters and virtual clusters.</p> <p>Support both <a href="/en/guide/user-guide/run-a-pipeline.html#register-runtime-cluster">Command Line</a> and API for registering runtime clusters.</p> <h2 id="prerequisites"><a href="#prerequisites" class="header-anchor">#</a> Prerequisites</h2> <h3 id="create-access-token"><a href="#create-access-token" class="header-anchor">#</a> Create Access Token</h3> <p>You need to create an access token as a request header for requesting APIs. For more information, refer to <a href="/en/guide/user-guide/run-a-pipeline.html#register-a-gitlab-account">Register a GitLab Account</a>.</p> <h3 id="import-certificates"><a href="#import-certificates" class="header-anchor">#</a> Import Certificates</h3> <p>If you want to access Nautes API Server using the HTTPS protocol, you need to <a href="/en/guide/user-guide/run-a-pipeline.html#import-certificates">import certificates</a>.</p> <h2 id="register-physical-cluster-api"><a href="#register-physical-cluster-api" class="header-anchor">#</a> Register Physical Cluster（API）</h2> <h3 id="compose-physical-cluster-registration-request"><a href="#compose-physical-cluster-registration-request" class="header-anchor">#</a> Compose Physical Cluster Registration Request</h3> <p>Compose an API request example by API definition <code>Cluster_SaveCluster</code> and add the access token as a request header.</p> <div class="language-Shell extra-class"><pre class="language-shell"><code>    <span class="token comment"># Replace the variable $api-server-address with the access address of the Nautes API Server</span>
    <span class="token comment"># Replace the variable $gitlab-access-token with the GitLab access token</span>
    <span class="token comment"># Replace the variable $cluster-name with the cluster name</span>
    <span class="token function">curl</span> <span class="token parameter variable">-X</span> <span class="token string">'POST'</span> <span class="token punctuation">\</span>
        <span class="token string">'HTTP://$api-server-address/api/v1/clusters/$cluster-name'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'accept: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Content-Type: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Authorization: Bearer $gitlab-access-token'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-d</span> <span class="token string">'{
                # Cluster API SERVER URL. Replace the variable with the address of the physical cluster.
                &quot;api_server&quot;: $api-server,
                # Cluster kind. Currently only supports Kubernetes.
                &quot;cluster_kind&quot;: &quot;kubernetes&quot;,
                # Cluster type: virtual or physical
                &quot;cluster_type&quot;: $cluster-type,
                # Cluster usage: host or worker
                &quot;usage&quot;: $usage,
                # Work type: pipeline or deployment
                &quot;worker_type&quot;: $worker-type,
                # Primary domain: Replace $cluster-ip with the host cluster IP.
                &quot;primary_domain&quot;: &quot;$cluster-ip.nip.io&quot;,
                # Tekton domain：When the worker_type is set to '</span>pipeline<span class="token string">', the property should be filled in. Replace $cluster-ip with the host cluster IP.
                &quot;tekton_host&quot;: &quot;tekton.$cluster-name.$cluster-ip.nip.io&quot;,
                # ArgoCD domain. Replace $cluster-ip with the cluster IP.
                &quot;argocd_host&quot;: &quot;argocd.$cluster-name.$cluster-ip.nip.io&quot;,
                # Traefik configuration
                &quot;traefik&quot;: {
                  &quot;http_node_port&quot;: &quot;30080&quot;,
                  &quot;https_node_port&quot;: &quot;30443&quot;
                },
                # Content of the kubeconfig file of the cluster. Replace the variable with the kubeconfig of the physical cluster, 
                # and ensure that the kubeconfig has escaped newline characters.
                &quot;kubeconfig&quot;: $kubeconfig
            }'</span>
</code></pre></div><p>The request example for the project pipeline runtime cluster after replacing variables is shown below:</p> <div class="language-Shell extra-class"><pre class="language-shell"><code>    <span class="token function">curl</span> <span class="token parameter variable">-X</span> <span class="token string">'POST'</span> <span class="token punctuation">\</span>
        <span class="token string">'HTTP://xxx.xxx.xxx.xxx:xxxxx/api/v1/clusters/physical-worker-pipeline'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'accept: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Content-Type: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Authorization: Bearer xxxxxxxxxxxxxxxxxxxxxxxxxx'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-d</span> <span class="token string">'{
                &quot;api_server&quot;: &quot;https://8.217.50.114:6443&quot;,
                &quot;cluster_kind&quot;: &quot;kubernetes&quot;,
                &quot;cluster_type&quot;: &quot;physical&quot;,
                &quot;usage&quot;: &quot;worker&quot;,
                &quot;worker_type&quot;: &quot;pipeline&quot;,
                &quot;primary_domain&quot;: &quot;8.217.50.114.nip.io&quot;,
                &quot;tekton_host&quot;: &quot;tekton.physical-worker-pipeline.8.217.50.114.nip.io&quot;,
                &quot;argocd_host&quot;: &quot;argocd.physical-worker-pipeline.8.217.50.114.nip.io&quot;,
                &quot;traefik&quot;: {
                  &quot;http_node_port&quot;: &quot;30080&quot;,
                  &quot;https_node_port&quot;: &quot;30443&quot;
                },
                &quot;kubeconfig&quot;: &quot;apiVersion: v1\nclusters:\n- cluster:\n    certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJkakNDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdGMyVnkKZG1WeUxXTmhRREUyT0RZeE5EQTBOelF3SGhjTk1qTXdOakEzTVRJeU1URTBXaGNOTXpNd05qQTBNVEl5TVRFMApXakFqTVNFd0h3WURWUVFEREJock0zTXRjMlZ5ZG1WeUxXTmhRREUyT0RZeE5EQTBOelF3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFRdnRkRTdSVW1BSHYxOHdEWDF2L2pucWFFU3NmcjduUm5wbTViYjZ0NmEKRDZmZHg0NnVRYitDYWFjVXJUMVVycTVOSTJNTHhHSC8yS0xBL2Y0T2V4WjRvMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVW13L1FHSXc1N2VtQjhnaDhwQVpGCmdrVG1sQzB3Q2dZSUtvWkl6ajBFQXdJRFJ3QXdSQUlnU0FCZDdMdEVxYnY3Q0pqQ2VHa1ljL1ZqUkh3NnNTSkUKMHJFV3ZyVFFoSFlDSUJoZXpPOXRTVVpxV3dlVGk1SFZTUEhYNnRmR2E0SkpkTlNuN01ma0RMZnMKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=\n    server: https://10.204.118.23:6443\n  name: default\ncontexts:\n- context:\n    cluster: default\n    user: default\n  name: default\ncurrent-context: default\nkind: Config\npreferences: {}\nusers:\n- name: default\n  user:\n    client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJrRENDQVRlZ0F3SUJBZ0lJT0MvTUZodzFVSXd3Q2dZSUtvWkl6ajBFQXdJd0l6RWhNQjhHQTFVRUF3d1kKYXpOekxXTnNhV1Z1ZEMxallVQXhOamcyTVRRd05EYzBNQjRYRFRJek1EWXdOekV5TWpFeE5Gb1hEVEkwTURZdwpOakV5TWpFeE5Gb3dNREVYTUJVR0ExVUVDaE1PYzNsemRHVnRPbTFoYzNSbGNuTXhGVEFUQmdOVkJBTVRESE41CmMzUmxiVHBoWkcxcGJqQlpNQk1HQnlxR1NNNDlBZ0VHQ0NxR1NNNDlBd0VIQTBJQUJDdmFlak9Yc09NVWtsd1oKU25nL1dXTy9zTE5XRG9rMzF3Z3A4ditVVWZ6b25SRGtGRzRJK3RYNXpwYUF6TXlsZndmWWc2aUZ1RmkzaWRkKwpQRlpod0d1alNEQkdNQTRHQTFVZER3RUIvd1FFQXdJRm9EQVRCZ05WSFNVRUREQUtCZ2dyQmdFRkJRY0RBakFmCkJnTlZIU01FR0RBV2dCUStpcXZQYVQxRW5qZVA0SlhqWkxSYWd1NnRzVEFLQmdncWhrak9QUVFEQWdOSEFEQkUKQWlCMVFtQ2NyRHZGSUxVMUl3K01laURkZERMQkhoQVdhOUJ1T3NCRFZLU0F5Z0lnSEgyOVF5UDg1aEZQUkd6dQpQZENjdjdVN01NL2lpOG5zbGQrTy8ySW8yYnc9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJkekNDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdFkyeHAKWlc1MExXTmhRREUyT0RZeE5EQTBOelF3SGhjTk1qTXdOakEzTVRJeU1URTBXaGNOTXpNd05qQTBNVEl5TVRFMApXakFqTVNFd0h3WURWUVFEREJock0zTXRZMnhwWlc1MExXTmhRREUyT0RZeE5EQTBOelF3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFReXM3c3JZWEFFczBPa2lqWkt0R1hEZk1HWlhzMGJySGx4T1dwRGZ0d2cKK2xFMGRaNFJ4U1hYVWhCNEo0ZjB0ZUhXRk5NVmU3c1pjN2kyNTAwbWVoUUVvMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVVBvcXJ6Mms5Uko0M2orQ1Y0MlMwCldvTHVyYkV3Q2dZSUtvWkl6ajBFQXdJRFNBQXdSUUloQUxjQlllRGFEMTc0YVpaUU1CQm53NHAvNmY5S1hVb2YKM2tpRFFXNUNLTWgzQWlCdWFPR252Yml2ajRDeHJPckgxWEZSUS9VR2tXYmtGWEUweExWc1VJZmprQT09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K\n    client-key-data: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSUZ6TDY2TDZMWGkvM3IzUEdFYTRMUmxlUXoybGUwU0R4cFdPV1dMRzZIamhvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFSzlwNk01ZXc0eFNTWEJsS2VEOVpZNyt3czFZT2lUZlhDQ255LzVSUi9PaWRFT1FVYmdqNgoxZm5PbG9ETXpLVi9COWlEcUlXNFdMZUoxMzQ4Vm1IQWF3PT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=&quot;
            }'</span>
</code></pre></div><p>The request example for the deployment runtime cluster after replacing variables is shown below:</p> <div class="language-Shell extra-class"><pre class="language-shell"><code>    <span class="token function">curl</span> <span class="token parameter variable">-X</span> <span class="token string">'POST'</span> <span class="token punctuation">\</span>
        <span class="token string">'HTTP://xxx.xxx.xxx.xxx:xxxxx/api/v1/clusters/physical-worker-deployment'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'accept: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Content-Type: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Authorization: Bearer xxxxxxxxxxxxxxxxxxxxxxxxxx'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-d</span> <span class="token string">'{
                &quot;api_server&quot;: &quot;https://8.217.50.114:6443&quot;,
                &quot;cluster_kind&quot;: &quot;kubernetes&quot;,
                &quot;cluster_type&quot;: &quot;physical&quot;,
                &quot;usage&quot;: &quot;worker&quot;,
                &quot;worker_type&quot;: &quot;deployment&quot;,
                &quot;primary_domain&quot;: &quot;8.217.50.114.nip.io&quot;,
                &quot;argocd_host&quot;: &quot;argocd.physical-worker-deployment.8.217.50.114.nip.io&quot;,
                &quot;traefik&quot;: {
                  &quot;http_node_port&quot;: &quot;30080&quot;,
                  &quot;https_node_port&quot;: &quot;30443&quot;
                },
                &quot;kubeconfig&quot;: &quot;apiVersion: v1\nclusters:\n- cluster:\n    certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJkakNDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdGMyVnkKZG1WeUxXTmhRREUyT0RZeE5EQTBOelF3SGhjTk1qTXdOakEzTVRJeU1URTBXaGNOTXpNd05qQTBNVEl5TVRFMApXakFqTVNFd0h3WURWUVFEREJock0zTXRjMlZ5ZG1WeUxXTmhRREUyT0RZeE5EQTBOelF3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFRdnRkRTdSVW1BSHYxOHdEWDF2L2pucWFFU3NmcjduUm5wbTViYjZ0NmEKRDZmZHg0NnVRYitDYWFjVXJUMVVycTVOSTJNTHhHSC8yS0xBL2Y0T2V4WjRvMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVW13L1FHSXc1N2VtQjhnaDhwQVpGCmdrVG1sQzB3Q2dZSUtvWkl6ajBFQXdJRFJ3QXdSQUlnU0FCZDdMdEVxYnY3Q0pqQ2VHa1ljL1ZqUkh3NnNTSkUKMHJFV3ZyVFFoSFlDSUJoZXpPOXRTVVpxV3dlVGk1SFZTUEhYNnRmR2E0SkpkTlNuN01ma0RMZnMKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=\n    server: https://10.204.118.23:6443\n  name: default\ncontexts:\n- context:\n    cluster: default\n    user: default\n  name: default\ncurrent-context: default\nkind: Config\npreferences: {}\nusers:\n- name: default\n  user:\n    client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJrRENDQVRlZ0F3SUJBZ0lJT0MvTUZodzFVSXd3Q2dZSUtvWkl6ajBFQXdJd0l6RWhNQjhHQTFVRUF3d1kKYXpOekxXTnNhV1Z1ZEMxallVQXhOamcyTVRRd05EYzBNQjRYRFRJek1EWXdOekV5TWpFeE5Gb1hEVEkwTURZdwpOakV5TWpFeE5Gb3dNREVYTUJVR0ExVUVDaE1PYzNsemRHVnRPbTFoYzNSbGNuTXhGVEFUQmdOVkJBTVRESE41CmMzUmxiVHBoWkcxcGJqQlpNQk1HQnlxR1NNNDlBZ0VHQ0NxR1NNNDlBd0VIQTBJQUJDdmFlak9Yc09NVWtsd1oKU25nL1dXTy9zTE5XRG9rMzF3Z3A4ditVVWZ6b25SRGtGRzRJK3RYNXpwYUF6TXlsZndmWWc2aUZ1RmkzaWRkKwpQRlpod0d1alNEQkdNQTRHQTFVZER3RUIvd1FFQXdJRm9EQVRCZ05WSFNVRUREQUtCZ2dyQmdFRkJRY0RBakFmCkJnTlZIU01FR0RBV2dCUStpcXZQYVQxRW5qZVA0SlhqWkxSYWd1NnRzVEFLQmdncWhrak9QUVFEQWdOSEFEQkUKQWlCMVFtQ2NyRHZGSUxVMUl3K01laURkZERMQkhoQVdhOUJ1T3NCRFZLU0F5Z0lnSEgyOVF5UDg1aEZQUkd6dQpQZENjdjdVN01NL2lpOG5zbGQrTy8ySW8yYnc9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJkekNDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdFkyeHAKWlc1MExXTmhRREUyT0RZeE5EQTBOelF3SGhjTk1qTXdOakEzTVRJeU1URTBXaGNOTXpNd05qQTBNVEl5TVRFMApXakFqTVNFd0h3WURWUVFEREJock0zTXRZMnhwWlc1MExXTmhRREUyT0RZeE5EQTBOelF3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFReXM3c3JZWEFFczBPa2lqWkt0R1hEZk1HWlhzMGJySGx4T1dwRGZ0d2cKK2xFMGRaNFJ4U1hYVWhCNEo0ZjB0ZUhXRk5NVmU3c1pjN2kyNTAwbWVoUUVvMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVVBvcXJ6Mms5Uko0M2orQ1Y0MlMwCldvTHVyYkV3Q2dZSUtvWkl6ajBFQXdJRFNBQXdSUUloQUxjQlllRGFEMTc0YVpaUU1CQm53NHAvNmY5S1hVb2YKM2tpRFFXNUNLTWgzQWlCdWFPR252Yml2ajRDeHJPckgxWEZSUS9VR2tXYmtGWEUweExWc1VJZmprQT09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K\n    client-key-data: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSUZ6TDY2TDZMWGkvM3IzUEdFYTRMUmxlUXoybGUwU0R4cFdPV1dMRzZIamhvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFSzlwNk01ZXc0eFNTWEJsS2VEOVpZNyt3czFZT2lUZlhDQ255LzVSUi9PaWRFT1FVYmdqNgoxZm5PbG9ETXpLVi9COWlEcUlXNFdMZUoxMzQ4Vm1IQWF3PT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=&quot;
            }'</span>
</code></pre></div><h3 id="execute-physical-cluster-registration-request"><a href="#execute-physical-cluster-registration-request" class="header-anchor">#</a> Execute Physical Cluster Registration Request</h3> <p>Use the curl command or other tools to execute the API request to register a physical cluster.</p> <p>After the request is successful, the physical cluster's resource file will be written to the tenant configuration repository, and the physical cluster will be registered as a runtime cluster in the tenant management cluster based on the resource file. Upon successful registration, components such as ArgoCD, ArgoRollouts, Tekton, ExternalSecret, HNC, and Vault-agent will be installed in the physical cluster.</p> <blockquote><p>If your account is a member of the tenant configuration repository and has write permission to the <code>main</code> branch, you can register runtime clusters.</p></blockquote> <h2 id="register-virtual-cluster-api"><a href="#register-virtual-cluster-api" class="header-anchor">#</a> Register Virtual Cluster（API）</h2> <p>When registering a virtual cluster as a runtime cluster, you need to first register the physical cluster as the host cluster, and then register the virtual cluster to the host cluster.</p> <h3 id="compose-host-cluster-registration-request"><a href="#compose-host-cluster-registration-request" class="header-anchor">#</a> Compose Host Cluster Registration Request</h3> <p>Compose an API request example by API definition <code>Cluster_SaveCluster</code> and add the access token as a request header.</p> <div class="language-Shell extra-class"><pre class="language-shell"><code>    <span class="token comment"># Replace the variable $api-server-address with the access address of the Nautes API Server</span>
    <span class="token comment"># Replace the variable $gitlab-access-token with the GitLab access token</span>
    <span class="token comment"># Replace the variable $cluster-name with the cluster name</span>
    <span class="token function">curl</span> <span class="token parameter variable">-X</span> <span class="token string">'POST'</span> <span class="token punctuation">\</span>
        <span class="token string">'HTTP://$api-server-address/api/v1/clusters/$cluster-name'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'accept: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Content-Type: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Authorization: Bearer $gitlab-access-token'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-d</span> <span class="token string">'{
                # Cluster API SERVER URL. Replace the variable with the address of the host cluster.
                &quot;api_server&quot;: $api-server,
                # Cluster kind. Currently only supports Kubernetes.
                &quot;cluster_kind&quot;: &quot;kubernetes&quot;,
                # Cluster type: virtual or physical
                &quot;cluster_type&quot;: $cluster-type,
                # Cluster usage: host or worker
                &quot;usage&quot;: $usage,
                # Primary domain: Replace $cluster-ip with the host cluster IP.
                &quot;primary_domain&quot;: &quot;$cluster-ip.nip.io&quot;
                # Traefik configuration
                &quot;traefik&quot;: {
                  &quot;http_node_port&quot;: &quot;30080&quot;,
                  &quot;https_node_port&quot;: &quot;30443&quot;
                },
                # Content of the kubeconfig file of the cluster. Replace the variable with the kubeconfig of the host cluster,
                # and ensure that the kubeconfig has escaped newline characters.
                &quot;kubeconfig&quot;: $kubeconfig
            }'</span>
</code></pre></div><p>The request example after replacing the variables is shown below:</p> <div class="language-Shell extra-class"><pre class="language-shell"><code>    <span class="token function">curl</span> <span class="token parameter variable">-X</span> <span class="token string">'POST'</span> <span class="token punctuation">\</span>
        <span class="token string">'HTTP://xxx.xxx.xxx.xxx:xxxxx/api/v1/clusters/cluster-host'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'accept: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Content-Type: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Authorization: Bearer xxxxxxxxxxxxxxxxxxxxxxxxxx'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-d</span> <span class="token string">'{
                &quot;api_server&quot;: &quot;https://8.217.50.114:6443&quot;,
                &quot;cluster_kind&quot;: &quot;kubernetes&quot;,
                &quot;cluster_type&quot;: &quot;physical&quot;,
                &quot;usage&quot;: &quot;host&quot;,
                &quot;primary_domain&quot;: &quot;8.217.50.114.nip.io&quot;,
                &quot;traefik&quot;: {
                  &quot;http_node_port&quot;: &quot;30080&quot;,
                  &quot;https_node_port&quot;: &quot;30443&quot;
                },
                &quot;kubeconfig&quot;: &quot;apiVersion: v1\nclusters:\n- cluster:\n    certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJkakNDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdGMyVnkKZG1WeUxXTmhRREUyT0RZeE5EQTBOelF3SGhjTk1qTXdOakEzTVRJeU1URTBXaGNOTXpNd05qQTBNVEl5TVRFMApXakFqTVNFd0h3WURWUVFEREJock0zTXRjMlZ5ZG1WeUxXTmhRREUyT0RZeE5EQTBOelF3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFRdnRkRTdSVW1BSHYxOHdEWDF2L2pucWFFU3NmcjduUm5wbTViYjZ0NmEKRDZmZHg0NnVRYitDYWFjVXJUMVVycTVOSTJNTHhHSC8yS0xBL2Y0T2V4WjRvMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVW13L1FHSXc1N2VtQjhnaDhwQVpGCmdrVG1sQzB3Q2dZSUtvWkl6ajBFQXdJRFJ3QXdSQUlnU0FCZDdMdEVxYnY3Q0pqQ2VHa1ljL1ZqUkh3NnNTSkUKMHJFV3ZyVFFoSFlDSUJoZXpPOXRTVVpxV3dlVGk1SFZTUEhYNnRmR2E0SkpkTlNuN01ma0RMZnMKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=\n    server: https://10.204.118.23:6443\n  name: default\ncontexts:\n- context:\n    cluster: default\n    user: default\n  name: default\ncurrent-context: default\nkind: Config\npreferences: {}\nusers:\n- name: default\n  user:\n    client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJrRENDQVRlZ0F3SUJBZ0lJT0MvTUZodzFVSXd3Q2dZSUtvWkl6ajBFQXdJd0l6RWhNQjhHQTFVRUF3d1kKYXpOekxXTnNhV1Z1ZEMxallVQXhOamcyTVRRd05EYzBNQjRYRFRJek1EWXdOekV5TWpFeE5Gb1hEVEkwTURZdwpOakV5TWpFeE5Gb3dNREVYTUJVR0ExVUVDaE1PYzNsemRHVnRPbTFoYzNSbGNuTXhGVEFUQmdOVkJBTVRESE41CmMzUmxiVHBoWkcxcGJqQlpNQk1HQnlxR1NNNDlBZ0VHQ0NxR1NNNDlBd0VIQTBJQUJDdmFlak9Yc09NVWtsd1oKU25nL1dXTy9zTE5XRG9rMzF3Z3A4ditVVWZ6b25SRGtGRzRJK3RYNXpwYUF6TXlsZndmWWc2aUZ1RmkzaWRkKwpQRlpod0d1alNEQkdNQTRHQTFVZER3RUIvd1FFQXdJRm9EQVRCZ05WSFNVRUREQUtCZ2dyQmdFRkJRY0RBakFmCkJnTlZIU01FR0RBV2dCUStpcXZQYVQxRW5qZVA0SlhqWkxSYWd1NnRzVEFLQmdncWhrak9QUVFEQWdOSEFEQkUKQWlCMVFtQ2NyRHZGSUxVMUl3K01laURkZERMQkhoQVdhOUJ1T3NCRFZLU0F5Z0lnSEgyOVF5UDg1aEZQUkd6dQpQZENjdjdVN01NL2lpOG5zbGQrTy8ySW8yYnc9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJkekNDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdFkyeHAKWlc1MExXTmhRREUyT0RZeE5EQTBOelF3SGhjTk1qTXdOakEzTVRJeU1URTBXaGNOTXpNd05qQTBNVEl5TVRFMApXakFqTVNFd0h3WURWUVFEREJock0zTXRZMnhwWlc1MExXTmhRREUyT0RZeE5EQTBOelF3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFReXM3c3JZWEFFczBPa2lqWkt0R1hEZk1HWlhzMGJySGx4T1dwRGZ0d2cKK2xFMGRaNFJ4U1hYVWhCNEo0ZjB0ZUhXRk5NVmU3c1pjN2kyNTAwbWVoUUVvMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVVBvcXJ6Mms5Uko0M2orQ1Y0MlMwCldvTHVyYkV3Q2dZSUtvWkl6ajBFQXdJRFNBQXdSUUloQUxjQlllRGFEMTc0YVpaUU1CQm53NHAvNmY5S1hVb2YKM2tpRFFXNUNLTWgzQWlCdWFPR252Yml2ajRDeHJPckgxWEZSUS9VR2tXYmtGWEUweExWc1VJZmprQT09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K\n    client-key-data: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSUZ6TDY2TDZMWGkvM3IzUEdFYTRMUmxlUXoybGUwU0R4cFdPV1dMRzZIamhvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFSzlwNk01ZXc0eFNTWEJsS2VEOVpZNyt3czFZT2lUZlhDQ255LzVSUi9PaWRFT1FVYmdqNgoxZm5PbG9ETXpLVi9COWlEcUlXNFdMZUoxMzQ4Vm1IQWF3PT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=&quot;
            }'</span>
</code></pre></div><h3 id="execute-host-cluster-registration-request"><a href="#execute-host-cluster-registration-request" class="header-anchor">#</a> Execute Host Cluster Registration Request</h3> <p>Use the curl command or other tools to execute the API request to register a host cluster.</p> <p>After the request is successful, the host cluster's resource file will be written to the tenant configuration repository, and the host cluster will be registered in the tenant management cluster based on the resource file. Upon successful registration, components such as Traefik will be installed in the host cluster.</p> <h3 id="compose-virtual-cluster-registration-request"><a href="#compose-virtual-cluster-registration-request" class="header-anchor">#</a> Compose Virtual Cluster Registration Request</h3> <p>Compose an API request example by API definition <code>Cluster_SaveCluster</code> and add the access token as a request header.</p> <div class="language-Shell extra-class"><pre class="language-shell"><code>    <span class="token comment"># Replace the variable $api-server-address with the access address of the Nautes API Server</span>
    <span class="token comment"># Replace the variable $gitlab-access-token with the GitLab access token</span>
    <span class="token comment"># Replace the variable $cluster-name with the cluster name</span>
    <span class="token function">curl</span> <span class="token parameter variable">-X</span> <span class="token string">'POST'</span> <span class="token punctuation">\</span>
        <span class="token string">'HTTP://$api-server-address/api/v1/clusters/$cluster-name'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'accept: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Content-Type: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Authorization: Bearer $gitlab-access-token'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-d</span> <span class="token string">'{
                # Cluster API SERVER URL. Replace the parameter with the format '</span>https://<span class="token variable">$hostcluster</span>-ip:<span class="token variable">$api</span>-server-port<span class="token string">',
                # where $hostcluster-ip refers to the IP of the host cluster 
                # and $api-server-port refers to the API SERVER port of the virtual cluster.
                &quot;api_server&quot;: $api-server,
                # Cluster kind: Currently only supports Kubernetes
                &quot;cluster_kind&quot;: &quot;kubernetes&quot;,
                # Cluster type: virtual or physical
                &quot;cluster_type&quot;: $cluster-type,
                # Cluster usage: host or worker
                &quot;usage&quot;: $usage,
                # Work type: pipeline or deployment
                &quot;worker_type&quot;: $worker_type,
                # Host cluster: the property is only available for virtual type clusters. Replace the parameter with the name of the host cluster.
                &quot;host_cluster&quot;: $host-cluster,
                # Primary domain: Replace $cluster-ip with the host cluster IP.
                &quot;primary_domain&quot;: &quot;$cluster-ip.nip.io&quot;
                # Tekton domain：When the worker_type is set to '</span>pipeline<span class="token string">', the property should be filled in. Replace $cluster-ip with the host cluster IP.
                &quot;tekton_host&quot;: &quot;tekton.$cluster-name.$cluster-ip.nip.io&quot;
                # ArgoCD domain. Replace $cluster_ip with the host cluster IP.
                &quot;argocd_host&quot;: &quot;argocd.$cluster-name.$cluster-ip.nip.io&quot;,
                # Virtual cluster configuration: the property is only available for virtual type clusters.
                &quot;vcluster&quot;: {
                  # API SERVER port 
                  &quot;https_node_port&quot;: $api-server-port,
                }
            }'</span>
</code></pre></div><p>The request example for the project pipeline runtime cluster after replacing variables is shown below:</p> <div class="language-Shell extra-class"><pre class="language-shell"><code>    <span class="token function">curl</span> <span class="token parameter variable">-X</span> <span class="token string">'POST'</span> <span class="token punctuation">\</span>
        <span class="token string">'HTTP://xxx.xxx.xxx.xxx:xxxxx/api/v1/clusters/virtual-worker-pipeline'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'accept: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Content-Type: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Authorization: Bearer xxxxxxxxxxxxxxxxxxxxxxxxxx'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-d</span> <span class="token string">'{
                &quot;api_server&quot;: &quot;https://8.217.50.114:31456&quot;,
                &quot;cluster_kind&quot;: &quot;kubernetes&quot;,
                &quot;cluster_type&quot;: &quot;virtual&quot;,
                &quot;usage&quot;: &quot;worker&quot;,
                &quot;worker_type&quot;: &quot;pipeline&quot;,
                &quot;host_cluster&quot;: &quot;cluster-host&quot;,
                &quot;primary_domain&quot;: &quot;8.217.50.114.nip.io&quot;,
                &quot;teoken_host&quot;: &quot;tekton.virtual-worker-pipeline.8.217.50.114.nip.io&quot;,
                &quot;argocd_host&quot;: &quot;argocd.virtual-worker-pipeline.8.217.50.114.nip.io&quot;,
                &quot;vcluster&quot;: {
                  &quot;https_node_port&quot;: &quot;31456&quot;
                }
            }'</span>
</code></pre></div><p>The request example for the deployment runtime cluster after replacing variables is shown below:</p> <div class="language-Shell extra-class"><pre class="language-shell"><code>    <span class="token function">curl</span> <span class="token parameter variable">-X</span> <span class="token string">'POST'</span> <span class="token punctuation">\</span>
        <span class="token string">'HTTP://xxx.xxx.xxx.xxx:xxxxx/api/v1/clusters/virtual-worker-deployment'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'accept: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Content-Type: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Authorization: Bearer xxxxxxxxxxxxxxxxxxxxxxxxxx'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-d</span> <span class="token string">'{
                &quot;api_server&quot;: &quot;https://8.217.50.114:31456&quot;,
                &quot;cluster_kind&quot;: &quot;kubernetes&quot;,
                &quot;cluster_type&quot;: &quot;virtual&quot;,
                &quot;usage&quot;: &quot;worker&quot;,
                &quot;worker_type&quot;: &quot;deployment&quot;,
                &quot;host_cluster&quot;: &quot;cluster-host&quot;,
                &quot;primary_domain&quot;: &quot;8.217.50.114.nip.io&quot;,
                &quot;argocd_host&quot;: &quot;argocd.virtual-worker-deployment.8.217.50.114.nip.io&quot;,
                &quot;vcluster&quot;: {
                  &quot;https_node_port&quot;: &quot;31456&quot;
                }
            }'</span>
</code></pre></div><h3 id="execute-virtual-cluster-registration-request"><a href="#execute-virtual-cluster-registration-request" class="header-anchor">#</a> Execute Virtual Cluster Registration Request</h3> <p>Use the curl command or other tools to execute the API request to register a virtual cluster.</p> <p>After the request is successful, the virtual cluster's resource file will be written to the tenant configuration repository, and the virtual cluster will be registered as a runtime cluster in the tenant management cluster based on the resource file. Upon successful registration, components such as ArgoCD, ArgoRollouts, Tekton, ExternalSecret, HNC, and Vault-agent will be installed in the virtual cluster.</p> <blockquote><p>If your account is a member of the tenant configuration repository and has write permission to the <code>main</code> branch, you can register runtime clusters.</p></blockquote> <h2 id="delete-physical-cluster-api"><a href="#delete-physical-cluster-api" class="header-anchor">#</a> Delete Physical Cluster（API）</h2> <blockquote><p>Please ensure that a physical cluster has been successfully registered.</p> <p>Before deleting the cluster, please ensure that the product configuration manifest has been successfully deleted. For more information, refer to the <a href="/en/guide/user-guide/clean-environment.html#delete-runtime">Delete Runtime (Command-Line)</a> or the APIs in <a href="/en/guide/user-guide/deployment-runtime.html#delete-deployment-runtime-api">Delete Deployment-Runtime</a>, <a href="/en/guide/user-guide/project-pipeline-runtime.html#delete-pipeline-runtime-api">Delete Pipeline-Runtime</a>, <a href="/en/guide/user-guide/environment.html#delete-environment-api">Delete Environment</a>, <a href="/en/guide/user-guide/code-repo.html#delete-repository-api">Delete Repository</a>, <a href="/en/guide/user-guide/project.html#delete-project-api">Delete Project</a>, <a href="/en/guide/user-guide/product.html#delete-product-api">Delete Product</a>.</p></blockquote> <h3 id="compose-physical-cluster-deletion-request"><a href="#compose-physical-cluster-deletion-request" class="header-anchor">#</a> Compose Physical Cluster Deletion Request</h3> <p>Compose an API request example by API definition <code>Cluster_DeleteCluster</code> and add the access token as a request header.</p> <div class="language-Shell extra-class"><pre class="language-shell"><code>    <span class="token function">curl</span> <span class="token parameter variable">-X</span> <span class="token string">'DELETE'</span> <span class="token punctuation">\</span>
        <span class="token string">'HTTP://$api-server-address/api/v1/clusters/$cluster-name'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'accept: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Authorization: Bearer $gitlab-access-token'</span>
</code></pre></div><p>The request example after replacing the variables is shown below:</p> <div class="language-Shell extra-class"><pre class="language-shell"><code>    <span class="token function">curl</span> <span class="token parameter variable">-X</span> <span class="token string">'DELETE'</span> <span class="token punctuation">\</span>
        <span class="token string">'HTTP://xxx.xxx.xxx.xxx:xxxxx/api/v1/clusters/physical-worker-deployment'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'accept: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Authorization: Bearer xxxxxxxxxxxxxxxxxxxx'</span>
</code></pre></div><h3 id="execute-physical-cluster-deletion-request"><a href="#execute-physical-cluster-deletion-request" class="header-anchor">#</a> Execute Physical Cluster Deletion Request</h3> <p>Use the curl command or other tools to execute the API request.</p> <p>After the request is successful, the cluster resource file in the tenant configuration repository will be deleted, and the physical cluster will be cleaned up.</p> <blockquote><p>If your account is a member of the tenant configuration repository and has write permission to the <code>main</code> branch, you can delete runtime clusters.</p></blockquote> <h2 id="delete-virtual-cluster-api"><a href="#delete-virtual-cluster-api" class="header-anchor">#</a> Delete Virtual Cluster（API）</h2> <blockquote><p>Please ensure that a virtual cluster has been successfully registered.</p> <p>Before deleting the cluster, please ensure that the product configuration manifest has been successfully deleted.</p></blockquote> <h3 id="compose-virtual-cluster-deletion-request"><a href="#compose-virtual-cluster-deletion-request" class="header-anchor">#</a> Compose Virtual Cluster Deletion Request</h3> <p>Compose an API request example by API definition <code>Cluster_DeleteCluster</code> and add the access token as a request header. The API request example is similar to <a href="#delete-physical-clusterapi">Delete Physical Cluster</a>:</p> <div class="language-Shell extra-class"><pre class="language-shell"><code>    <span class="token function">curl</span> <span class="token parameter variable">-X</span> <span class="token string">'DELETE'</span> <span class="token punctuation">\</span>
        <span class="token string">'HTTP://xxx.xxx.xxx.xxx:xxxxx/api/v1/clusters/virtual-worker-pipeline'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'accept: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Authorization: Bearer xxxxxxxxxxxxxxxxxxxx'</span>
</code></pre></div><h3 id="execute-virtual-cluster-deletion-request"><a href="#execute-virtual-cluster-deletion-request" class="header-anchor">#</a> Execute Virtual Cluster Deletion Request</h3> <p>Use the curl command or other tools to execute the API request.</p> <p>After the request is successful, the cluster resource file in the tenant configuration repository will be deleted, and the virtual cluster will be destroyed.</p> <h3 id="compose-host-cluster-deletion-request"><a href="#compose-host-cluster-deletion-request" class="header-anchor">#</a> Compose Host Cluster Deletion Request</h3> <p>Compose an API request example by API definition <code>Cluster_DeleteCluster</code> and add the access token as a request header. The API request example is similar to <a href="#delete-physical-clusterapi">Delete Physical Cluster</a>:</p> <div class="language-Shell extra-class"><pre class="language-shell"><code>    <span class="token function">curl</span> <span class="token parameter variable">-X</span> <span class="token string">'DELETE'</span> <span class="token punctuation">\</span>
        <span class="token string">'HTTP://xxx.xxx.xxx.xxx:xxxxx/api/v1/clusters/cluster-host'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'accept: application/json'</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-H</span> <span class="token string">'Authorization: Bearer xxxxxxxxxxxxxxxxxxxx'</span>
</code></pre></div><h3 id="execute-host-cluster-deletion-request"><a href="#execute-host-cluster-deletion-request" class="header-anchor">#</a> Execute Host Cluster Deletion Request</h3> <p>Use the curl command or other tools to execute the API request.</p> <p>After the request is successful, the cluster resource file in the tenant configuration repository will be deleted, and the host cluster will be cleaned up.</p> <blockquote><p>If your account is a member of the tenant configuration repository and has write permission to the <code>main</code> branch, you can delete runtime clusters.</p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/en/guide/user-guide/main-process.html" class="prev">
        Main Process
      </a></span> <span class="next"><a href="/en/guide/user-guide/product.html">
        Maintain Product
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.fc750a70.js" defer></script><script src="/assets/js/2.5cda13a8.js" defer></script><script src="/assets/js/38.cccd8d80.js" defer></script>
  </body>
</html>
