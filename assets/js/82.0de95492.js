(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{356:function(t,e,s){"use strict";s.r(e);var a=s(14),n=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"deploy-an-application"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#deploy-an-application"}},[t._v("#")]),t._v(" Deploy an Application")]),t._v(" "),e("p",[t._v("This document describes the process of registering a new Kubernetes cluster to Nautes, on which an application will be deployed.")]),t._v(" "),e("h2",{attrs:{id:"prerequisites"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[t._v("#")]),t._v(" Prerequisites")]),t._v(" "),e("h3",{attrs:{id:"register-a-gitlab-account"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#register-a-gitlab-account"}},[t._v("#")]),t._v(" Register a GitLab Account")]),t._v(" "),e("p",[t._v("After GitLab installation, you need to register an account and create a "),e("a",{attrs:{href:"https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("personal access token"),e("OutboundLink")],1),t._v(" with the scopes: api, read_api, read_repository, and write_repository.")]),t._v(" "),e("p",[t._v("The account needs to call the API for "),e("a",{attrs:{href:"#register-runtime-cluster"}},[t._v("managing the runtime clusters")]),t._v(", you need to add the account to the member list of the tenant configuration repository and ensure that the account can push code to the main branch.")]),t._v(" "),e("h3",{attrs:{id:"import-certificates"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#import-certificates"}},[t._v("#")]),t._v(" Import Certificates")]),t._v(" "),e("p",[t._v("If you want to access Nautes API Server using the HTTPS protocol, please download the ca.crt certificate from "),e("RouterLink",{attrs:{to:"/en/guide/user-guide/installation.html#check-the-installation-results"}},[t._v("the installation result")]),t._v(", and add ca.crt to the trusted certificate list of the server that executes the API.")],1),t._v(" "),e("h3",{attrs:{id:"prepare-a-server"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prepare-a-server"}},[t._v("#")]),t._v(" Prepare a Server")]),t._v(" "),e("p",[t._v("You need to prepare a server for installing the Kubernetes cluster. If you already have a Kubernetes cluster (with a public IP), you can skip this step.")]),t._v(" "),e("p",[t._v("The following will describe how to prepare a server and install a K3s cluster using Alibaba Cloud as an example.")]),t._v(" "),e("p",[t._v("Create an ECS cloud server. For more details, refer to "),e("a",{attrs:{href:"https://help.aliyun.com/document_detail/25422.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Elastic Compute Service (ECS)"),e("OutboundLink")],1),t._v(". After the server is successfully installed, install K3s on the server using the following command:")]),t._v(" "),e("div",{staticClass:"language-Shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Replace $PUBLIC_IP with the public IP of the server.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Replace $DEX_SERVER with the oauth_url located at /opt/nautes/out/service directory of the installation machine.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Download the ca.crt located at /opt/nautes/out/pki directory of the installation machine, and upload it to the /etc/ssl/certs/ directory of the server.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-sfL")]),t._v(" https://get.k3s.io "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("INSTALL_K3S_VERSION")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("v1.21.14+k3s1 "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("INSTALL_K3S_EXEC")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"--tls-san '),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PUBLIC_IP")]),t._v('"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" - server "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--disable")]),t._v(" servicelb "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--disable")]),t._v(" traefik "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--disable")]),t._v(" metrics-server --kube-apiserver-arg"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("oidc-issuer-url"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$DEX_SERVER")]),t._v(" --kube-apiserver-arg"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("oidc-client-id"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nautes --kube-apiserver-arg"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("oidc-ca-file"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/etc/ssl/certs/ca.crt --kube-apiserver-arg"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("oidc-groups-claim"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("groups "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${"),e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("HOME")]),t._v("}")]),t._v("/.kube\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${"),e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("HOME")]),t._v("}")]),t._v("/.kube\n/bin/cp "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" /etc/rancher/k3s/k3s.yaml "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${"),e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("HOME")]),t._v("}")]),t._v("/.kube/k3s-config\n/bin/cp "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" /etc/rancher/k3s/k3s.yaml "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${"),e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("HOME")]),t._v("}")]),t._v("/.kube/config\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("KUBECONFIG")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${"),e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("HOME")]),t._v("}")]),t._v("/.kube/config\n")])])]),e("p",[t._v("After the K3s installation is complete, you need to add an inbound rule for port 6443. For more information, refer to the "),e("a",{attrs:{href:"https://www.alibabacloud.com/help/en/elastic-compute-service/latest/create-a-security-group-2",target:"_blank",rel:"noopener noreferrer"}},[t._v("Security Group Rules"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h2",{attrs:{id:"installation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[t._v("#")]),t._v(" Installation")]),t._v(" "),e("p",[t._v("Using Alibaba Cloud as an example, this section describes the process of deploying Nautes on a public cloud. For more information, refer to the "),e("RouterLink",{attrs:{to:"/en/guide/user-guide/installation.html"}},[t._v("Installation")]),t._v(".")],1),t._v(" "),e("h2",{attrs:{id:"register-runtime-cluster"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#register-runtime-cluster"}},[t._v("#")]),t._v(" Register Runtime Cluster")]),t._v(" "),e("p",[t._v("Registering a runtime cluster involves adding a prepared Kubernetes cluster to the tenant management cluster and initializing its configuration through the tenant management cluster. After initialization, the cluster can function as a runtime environment for hosting applications.")]),t._v(" "),e("p",[t._v("The supported cluster types include physical clusters and virtual clusters.")]),t._v(" "),e("p",[t._v("When higher performance, isolation, and reliability are required for your application's runtime environment, it is recommended to use a "),e("a",{attrs:{href:"#register-physical-cluster"}},[t._v("physical cluster")]),t._v(". For other environments such as development, testing, and trial environments, a "),e("a",{attrs:{href:"#register-runtime-cluster"}},[t._v("virtual cluster")]),t._v(" can be used.")]),t._v(" "),e("h3",{attrs:{id:"register-physical-cluster"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#register-physical-cluster"}},[t._v("#")]),t._v(" Register Physical Cluster")]),t._v(" "),e("ol",[e("li",[t._v("Clone the command-line repository to your local machine.")])]),t._v(" "),e("div",{staticClass:"language-Shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/nautes-labs/cli.git\n")])])]),e("ol",{attrs:{start:"2"}},[e("li",[t._v("Replace the variables in the physical cluster property template located at the relative path "),e("code",[t._v("examples/demo-cluster-physical-worker.yaml")]),t._v(", including "),e("code",[t._v("$suffix")]),t._v(", "),e("code",[t._v("$api-server")]),t._v(", "),e("code",[t._v("$cluster_ip")]),t._v(" and "),e("code",[t._v("$kubeconfig")]),t._v(".")])]),t._v(" "),e("div",{staticClass:"language-Shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# View the kubeconfig for the physical cluster.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${"),e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("HOME")]),t._v("}")]),t._v("/.kube/config\n")])])]),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Physical cluster property template")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nautes.resource.nautes.io/v1alpha1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Cluster\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Cluster name")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"host-worker-$suffix"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Cluster API SERVER URL. Replace the variable with the address of the physical cluster.")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiServer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$api-server"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Cluster kind. Currently only supports Kubernetes.")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clusterKind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kubernetes"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Cluster type: virtual or physical")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clusterType")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"physical"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Cluster usage: host or worker")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("usage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"worker"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ArgoCD domain. Replace $cluster_name with the cluster name, $cluster_ip with the cluster IP.")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("argocdHost")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"argocd.$cluster_name.$cluster_ip.nip.io"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Traefik configuration")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("traefik")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("httpNodePort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"30080"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("httpsNodePort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"30443"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Content of the kubeconfig file of the cluster: Replace the variable with the kubeconfig of the physical cluster.")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kubeconfig")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),e("span",{pre:!0,attrs:{class:"token scalar string"}},[t._v('\n    "$kubeconfig"')]),t._v("\n")])])]),e("p",[t._v("The physical cluster property example after replacing the variables is shown below:")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nautes.resource.nautes.io/v1alpha1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Cluster\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"host-worker-aliyun-0412"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiServer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://8.217.50.114:6443"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clusterKind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kubernetes"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clusterType")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"physical"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("usage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"worker"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("argocdHost")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"argocd.host-worker-aliyun-0412.8.217.50.114.nip.io"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("traefik")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("httpNodePort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"30080"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("httpsNodePort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"30443"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kubeconfig")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),e("span",{pre:!0,attrs:{class:"token scalar string"}},[t._v("\n    apiVersion: v1\n    clusters:\n    - cluster:\n        certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJlRENDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdGMyVnkKZG1WeUxXTmhRREUyT0RFeU9UQXdPVFV3SGhjTk1qTXdOREV5TURrd01UTTFXaGNOTXpNd05EQTVNRGt3TVRNMQpXakFqTVNFd0h3WURWUVFEREJock0zTXRjMlZ5ZG1WeUxXTmhRREUyT0RFeU9UQXdPVFV3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFSMzRuTjVPWWhxb3MrekV1YXZsVDRleXE4ZFRVZ2pxcUdoN2Z6NkpMZEMKem1FN0cwZjE5K0hLcEw5cU1tSXVBaStRelBZZFNzWGJpR20rNjR0R0NuVkRvMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVUp0WVUxbkNvTXNNYWpVeUJGN3RVCndjZWJ6TW93Q2dZSUtvWkl6ajBFQXdJRFNRQXdSZ0loQU9hR2pWNlRpK2o1Yy9kWlV5a1pERml0OU9DdkFmZjEKWjJSVUJ6TkJTOUlhQWlFQTB1bzM2YUVGRnkvdWQ0eHREZnNkWmhYWmZOaXQ3c2N4SXREa1k5STlQUkU9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K\n        server: https://127.0.0.1:6443\n      name: default\n    contexts:\n    - context:\n        cluster: default\n        user: default\n      name: default\n    current-context: default\n    kind: Config\n    preferences: {}\n    users:\n    - name: default\n      user:\n        client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJrVENDQVRlZ0F3SUJBZ0lJSjYyRGdFT3JiM3d3Q2dZSUtvWkl6ajBFQXdJd0l6RWhNQjhHQTFVRUF3d1kKYXpOekxXTnNhV1Z1ZEMxallVQXhOamd4TWprd01EazFNQjRYRFRJek1EUXhNakE1TURFek5Wb1hEVEkwTURReApNVEE1TURFek5Wb3dNREVYTUJVR0ExVUVDaE1PYzNsemRHVnRPbTFoYzNSbGNuTXhGVEFUQmdOVkJBTVRESE41CmMzUmxiVHBoWkcxcGJqQlpNQk1HQnlxR1NNNDlBZ0VHQ0NxR1NNNDlBd0VIQTBJQUJJNnlLRlBKNENmS25BUFkKQ0Q5ZFVtZlZ5ekR2aFpEQUdhU1lYODVoWWRYZ0NKdmxHRmlad3dGN2ExKzEzdlQ5ZjE2MUJwSGhKTm9mYi9oeAozUVo1MWs2alNEQkdNQTRHQTFVZER3RUIvd1FFQXdJRm9EQVRCZ05WSFNVRUREQUtCZ2dyQmdFRkJRY0RBakFmCkJnTlZIU01FR0RBV2dCVHhiVTM2eC9iMnl3WU14SmpuUjF5L2w2cHZCREFLQmdncWhrak9QUVFEQWdOSUFEQkYKQWlFQS9rZ3FCOGJLZnNLSGNmaDBUSFQ2bTZNLzdrMzlNWmFGYlVCaE9GTzVDSW9DSURiRWNaeUxkc055R3lVVQpSTDl5K0hHcVJ3b1FTWGhOa1NrQjhlbkpsQTEzCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJkekNDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdFkyeHAKWlc1MExXTmhRREUyT0RFeU9UQXdPVFV3SGhjTk1qTXdOREV5TURrd01UTTFXaGNOTXpNd05EQTVNRGt3TVRNMQpXakFqTVNFd0h3WURWUVFEREJock0zTXRZMnhwWlc1MExXTmhRREUyT0RFeU9UQXdPVFV3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFTbnNEVkxLTU4xTWl4cHAwclRMRTBOVGdjamFRWFhmUmZmOThiOTRqd1gKYjRPNVh1aCtFclZwZ3BjamxRYjVZKzM0T1NwaG03TnVXWlA2OHBkUWhMTW5vMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVThXMU4rc2YyOXNzR0RNU1k1MGRjCnY1ZXFid1F3Q2dZSUtvWkl6ajBFQXdJRFNBQXdSUUloQUtXSStXQ2wwRFlJME5oVDBzbDkwSVRHRW05V2EyaE0KQXV4UXkrcDVUcGpzQWlBdWxFd0NkK2lWYXNVY2VHa2I4WU81dlduQitaTVJmSU1rYWRHSGhpSmlrdz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K\n        client-key-data: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSU5ZZFVkaER2SlFXcVNSRzR0d3gzQ2I4amhnck1HZlVOMG1uajV5dTRWZ1RvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFanJJb1U4bmdKOHFjQTlnSVAxMVNaOVhMTU8rRmtNQVpwSmhmem1GaDFlQUltK1VZV0puRApBWHRyWDdYZTlQMS9YclVHa2VFazJoOXYrSEhkQm5uV1RnPT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=")]),t._v("\n")])])]),e("ol",{attrs:{start:"3"}},[e("li",[t._v("Download the "),e("a",{attrs:{href:"https://github.com/nautes-labs/cli/releases/tag/v0.2.0",target:"_blank",rel:"noopener noreferrer"}},[t._v("command-line tool"),e("OutboundLink")],1),t._v(" and run the following command to register the physical cluster.")])]),t._v(" "),e("div",{staticClass:"language-Shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# examples/demo-cluster-physical-worker.yaml refers to the relative path of the template file in the command-line repository.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# gitlab-access-token refers to the GitLab access token.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# api-server-address refers to the access address of the Nautes API Server.")]),t._v("\nnautes apply "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" examples/demo-cluster-physical-worker.yaml "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$gitlab")]),t._v("-access-token "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$api")]),t._v("-server-address\n")])])]),e("h3",{attrs:{id:"register-virtual-cluster"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#register-virtual-cluster"}},[t._v("#")]),t._v(" Register Virtual Cluster")]),t._v(" "),e("p",[t._v("When registering a virtual cluster as a deployment runtime cluster, you need to first register the physical cluster as the host cluster, and then register the virtual cluster to the host cluster.")]),t._v(" "),e("ol",[e("li",[t._v("Clone the command-line repository to your local machine.")])]),t._v(" "),e("div",{staticClass:"language-Shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/nautes-labs/cli.git\n")])])]),e("ol",{attrs:{start:"2"}},[e("li",[t._v("Replace the variables in the host cluster property template located at the relative path "),e("code",[t._v("examples/demo-cluster-host.yaml")]),t._v(", including "),e("code",[t._v("$suffix")]),t._v(", "),e("code",[t._v("$api-server")]),t._v(", and "),e("code",[t._v("$kubeconfig")]),t._v(".")])]),t._v(" "),e("div",{staticClass:"language-Shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# View the kubeconfig for the host cluster.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${"),e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("HOME")]),t._v("}")]),t._v("/.kube/config\n")])])]),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Host cluster property template")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nautes.resource.nautes.io/v1alpha1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Cluster\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Cluster name")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"host-$suffix"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Cluster API SERVER URL. Replace the variable with the address of the host cluster.")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiServer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$api-server"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Cluster kind. Currently only supports Kubernetes.")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clusterKind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kubernetes"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Cluster type: virtual or physical")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clusterType")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"physical"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Cluster usage: host or worker")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("usage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"host"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Traefik configuration")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("traefik")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("httpNodePort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"30080"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("httpsNodePort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"30443"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Content of the kubeconfig file of the cluster. Replace the variable with the kubeconfig of the host cluster")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kubeconfig")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),e("span",{pre:!0,attrs:{class:"token scalar string"}},[t._v('\n    "$kubeconfig"')]),t._v("\n")])])]),e("p",[t._v("The host cluster property example after replacing the variables is shown below:")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nautes.resource.nautes.io/v1alpha1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Cluster\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"host-aliyun-114"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiServer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://8.217.50.114:6443"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clusterKind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kubernetes"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clusterType")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"physical"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("usage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"host"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("traefik")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("httpNodePort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"30080"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("httpsNodePort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"30443"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kubeconfig")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),e("span",{pre:!0,attrs:{class:"token scalar string"}},[t._v("\n    apiVersion: v1\n    clusters:\n    - cluster:\n        certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJlRENDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdGMyVnkKZG1WeUxXTmhRREUyT0RFeU9UQXdPVFV3SGhjTk1qTXdOREV5TURrd01UTTFXaGNOTXpNd05EQTVNRGt3TVRNMQpXakFqTVNFd0h3WURWUVFEREJock0zTXRjMlZ5ZG1WeUxXTmhRREUyT0RFeU9UQXdPVFV3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFSMzRuTjVPWWhxb3MrekV1YXZsVDRleXE4ZFRVZ2pxcUdoN2Z6NkpMZEMKem1FN0cwZjE5K0hLcEw5cU1tSXVBaStRelBZZFNzWGJpR20rNjR0R0NuVkRvMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVUp0WVUxbkNvTXNNYWpVeUJGN3RVCndjZWJ6TW93Q2dZSUtvWkl6ajBFQXdJRFNRQXdSZ0loQU9hR2pWNlRpK2o1Yy9kWlV5a1pERml0OU9DdkFmZjEKWjJSVUJ6TkJTOUlhQWlFQTB1bzM2YUVGRnkvdWQ0eHREZnNkWmhYWmZOaXQ3c2N4SXREa1k5STlQUkU9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K\n        server: https://127.0.0.1:6443\n      name: default\n    contexts:\n    - context:\n        cluster: default\n        user: default\n      name: default\n    current-context: default\n    kind: Config\n    preferences: {}\n    users:\n    - name: default\n      user:\n        client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJrVENDQVRlZ0F3SUJBZ0lJSjYyRGdFT3JiM3d3Q2dZSUtvWkl6ajBFQXdJd0l6RWhNQjhHQTFVRUF3d1kKYXpOekxXTnNhV1Z1ZEMxallVQXhOamd4TWprd01EazFNQjRYRFRJek1EUXhNakE1TURFek5Wb1hEVEkwTURReApNVEE1TURFek5Wb3dNREVYTUJVR0ExVUVDaE1PYzNsemRHVnRPbTFoYzNSbGNuTXhGVEFUQmdOVkJBTVRESE41CmMzUmxiVHBoWkcxcGJqQlpNQk1HQnlxR1NNNDlBZ0VHQ0NxR1NNNDlBd0VIQTBJQUJJNnlLRlBKNENmS25BUFkKQ0Q5ZFVtZlZ5ekR2aFpEQUdhU1lYODVoWWRYZ0NKdmxHRmlad3dGN2ExKzEzdlQ5ZjE2MUJwSGhKTm9mYi9oeAozUVo1MWs2alNEQkdNQTRHQTFVZER3RUIvd1FFQXdJRm9EQVRCZ05WSFNVRUREQUtCZ2dyQmdFRkJRY0RBakFmCkJnTlZIU01FR0RBV2dCVHhiVTM2eC9iMnl3WU14SmpuUjF5L2w2cHZCREFLQmdncWhrak9QUVFEQWdOSUFEQkYKQWlFQS9rZ3FCOGJLZnNLSGNmaDBUSFQ2bTZNLzdrMzlNWmFGYlVCaE9GTzVDSW9DSURiRWNaeUxkc055R3lVVQpSTDl5K0hHcVJ3b1FTWGhOa1NrQjhlbkpsQTEzCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJkekNDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdFkyeHAKWlc1MExXTmhRREUyT0RFeU9UQXdPVFV3SGhjTk1qTXdOREV5TURrd01UTTFXaGNOTXpNd05EQTVNRGt3TVRNMQpXakFqTVNFd0h3WURWUVFEREJock0zTXRZMnhwWlc1MExXTmhRREUyT0RFeU9UQXdPVFV3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFTbnNEVkxLTU4xTWl4cHAwclRMRTBOVGdjamFRWFhmUmZmOThiOTRqd1gKYjRPNVh1aCtFclZwZ3BjamxRYjVZKzM0T1NwaG03TnVXWlA2OHBkUWhMTW5vMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVThXMU4rc2YyOXNzR0RNU1k1MGRjCnY1ZXFid1F3Q2dZSUtvWkl6ajBFQXdJRFNBQXdSUUloQUtXSStXQ2wwRFlJME5oVDBzbDkwSVRHRW05V2EyaE0KQXV4UXkrcDVUcGpzQWlBdWxFd0NkK2lWYXNVY2VHa2I4WU81dlduQitaTVJmSU1rYWRHSGhpSmlrdz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K\n        client-key-data: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSU5ZZFVkaER2SlFXcVNSRzR0d3gzQ2I4amhnck1HZlVOMG1uajV5dTRWZ1RvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFanJJb1U4bmdKOHFjQTlnSVAxMVNaOVhMTU8rRmtNQVpwSmhmem1GaDFlQUltK1VZV0puRApBWHRyWDdYZTlQMS9YclVHa2VFazJoOXYrSEhkQm5uV1RnPT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=")]),t._v("\n")])])]),e("ol",{attrs:{start:"3"}},[e("li",[t._v("Download the "),e("a",{attrs:{href:"https://github.com/nautes-labs/cli/releases/tag/v0.2.0",target:"_blank",rel:"noopener noreferrer"}},[t._v("command-line tool"),e("OutboundLink")],1),t._v(" and run the following command to register the host cluster.")])]),t._v(" "),e("div",{staticClass:"language-Shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# examples/demo-cluster-host.yaml refers to the relative path of the template file in the command-line repository.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# gitlab-access-token refers to the GitLab access token.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# api-server-address refers to the access address of the Nautes API Server.")]),t._v("\nnautes apply "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" examples/demo-cluster-host.yaml "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$gitlab")]),t._v("-access-token "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$api")]),t._v("-server-address\n")])])]),e("ol",{attrs:{start:"4"}},[e("li",[t._v("Replace the variables in the virtual cluster property template located at the relative path "),e("code",[t._v("examples/demo-cluster-virtual-worker.yaml")]),t._v(", including "),e("code",[t._v("$suffix")]),t._v(", "),e("code",[t._v("$api-server")]),t._v(", "),e("code",[t._v("$host-cluster")]),t._v(", and "),e("code",[t._v("$api-server-port")]),t._v(".")])]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Virtual cluster property template")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nautes.resource.nautes.io/v1alpha1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Cluster\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Cluster name")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cluster-demo-$suffix"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Cluster API SERVER URL. Replace the parameter with the format 'https://$hostcluster-ip:$api-server-port', where $hostcluster-ip refers to the IP of the host cluster and $api-server-port refers to the API SERVER port of the virtual cluster.")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiServer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$api-server"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Cluster kind: Currently only supports Kubernetes")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clusterKind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kubernetes"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Cluster type: virtual or physical")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clusterType")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"virtual"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Cluster usage: host or worker")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("usage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"worker"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Host cluster: the property is only available for virtual type clusters. Replace the parameter with the name of the host cluster.")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hostCluster")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$host-cluster"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ArgoCD domain. Replace $cluster_name with the cluster name, $cluster_ip with the host cluster IP.")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("argocdHost")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"argocd.$cluster_name.$cluster_ip.nip.io"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Virtual cluster configuration: the property is only available for virtual type clusters.")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("vcluster")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# API SERVER port ")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("httpsNodePort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$api-server-port"')]),t._v("\n")])])]),e("p",[t._v("The virtual cluster property example after replacing the variables is shown below:")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nautes.resource.nautes.io/v1alpha1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Cluster\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vcluster-aliyun-0412"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiServer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://8.217.50.114:31456"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clusterKind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kubernetes"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clusterType")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"virtual"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("usage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"worker"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hostCluster")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"host-aliyun-114"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("argocdHost")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"argocd.vcluster-aliyun-0412.8.217.50.114.nip.io"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("vcluster")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("httpsNodePort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"31456"')]),t._v("\n")])])]),e("ol",{attrs:{start:"5"}},[e("li",[t._v("Run the following command to register the virtual cluster.")])]),t._v(" "),e("div",{staticClass:"language-Shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# examples/demo-cluster-virtual-worker.yaml refers to the relative path of the template file in the command-line repository.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# gitlab-access-token refers to the GitLab access token.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# api-server-address refers to the access address of the Nautes API Server.")]),t._v("\nnautes apply "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" examples/demo-cluster-virtual-worker.yaml "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$gitlab")]),t._v("-access-token "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$api")]),t._v("-server-address\n")])])]),e("h2",{attrs:{id:"prepare-runtime-environment"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prepare-runtime-environment"}},[t._v("#")]),t._v(" Prepare Runtime Environment")]),t._v(" "),e("p",[t._v("Preparing the runtime environment refers to initializing a basic environment for deploying a product in the runtime cluster, including resources such as namespaces, serviceAccounts, secrets, etc.")]),t._v(" "),e("p",[t._v("The following sections describe the entities related to creating a runtime environment through the command-line, including a product, a project, a code repository, an environment, and a deployment runtime.")]),t._v(" "),e("ol",[e("li",[t._v("Clone the command-line repository to your local machine.")])]),t._v(" "),e("div",{staticClass:"language-Shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/nautes-labs/cli.git\n")])])]),e("ol",{attrs:{start:"2"}},[e("li",[t._v("Replace the variables in the runtime environment property template located at the relative path "),e("code",[t._v("examples/demo-product.yaml")]),t._v(", including "),e("code",[t._v("$suffix")]),t._v(" and "),e("code",[t._v("$runtime-cluster")]),t._v(".")])]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Product")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nautes.resource.nautes.io/v1alpha1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Product\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("git")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gitlab")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Product name")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Product path")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("visibility")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" private\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("description")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parentID")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Environment")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nautes.resource.nautes.io/v1alpha1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Environment\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Environment name")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" env"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The product to which the environment belongs")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("product")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Runtime cluster related to the environment")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cluster")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $runtime"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cluster\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Environment type")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("envType")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" dev\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Project")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nautes.resource.nautes.io/v1alpha1"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Project\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Project name")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" project"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The product to which the project belongs")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("product")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("language")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" golang\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# CodeRepo")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nautes.resource.nautes.io/v1alpha1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" CodeRepo\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# CodeRepo name")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" coderepo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("codeRepoProvider")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gitlab\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("deploymentRuntime")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("pipelineRuntime")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The product to which the coderepo belongs")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("product")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The project to which the coderepo belongs")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("project")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" project"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("webhook")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("events")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"push_events"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("isolation")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" shared\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("git")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gitlab")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Repository name")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" coderepo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Repository path")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" coderepo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix \n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Repository visibility：private or public")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("visibility")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" private\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("description")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" coderepo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix \n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# DeploymentRuntime")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nautes.resource.nautes.io/v1alpha1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" DeploymentRuntime\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# DeploymentRuntime name")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" dr"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The target environment of the deployment runtime")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("destination")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" env"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("manifestsource")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The source coderepo of the deployment runtime")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("codeRepo")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" coderepo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The relative path of the source coderepo ")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" deployments\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The revision or branch of the source coderepo ")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targetRevision")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" main\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The product to which the deployment runtime belongs")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("product")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The project to which the deployment runtime belongs")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("projectsRef")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" project"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$suffix\n")])])]),e("p",[t._v("The runtime environment example after replacing the variables is shown below:")]),t._v(" "),e("blockquote",[e("p",[t._v("If the runtime environment's host cluster type is physical, you must set the spec.cluster of the Environment resource to the corresponding "),e("a",{attrs:{href:"#register-physical-cluster"}},[t._v("physical cluster")]),t._v(" name. If the runtime environment's host cluster type is virtual, you must set the spec.cluster of the Environment resource to the corresponding "),e("a",{attrs:{href:"#register-virtual-cluster"}},[t._v("virtual cluster")]),t._v(" name.")])]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nautes.resource.nautes.io/v1alpha1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Product\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("git")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gitlab")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("visibility")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" private\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("description")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parentID")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nautes.resource.nautes.io/v1alpha1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Environment\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" env"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("product")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cluster")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" host"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("worker"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("aliyun"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("envType")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" dev\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nautes.resource.nautes.io/v1alpha1"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Project\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" project"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("product")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("language")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" golang\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nautes.resource.nautes.io/v1alpha1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" CodeRepo\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" coderepo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("codeRepoProvider")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gitlab\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("deploymentRuntime")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("pipelineRuntime")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("product")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("project")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" project"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("webhook")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("events")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"push_events"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("isolation")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" shared\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("git")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gitlab")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" coderepo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" coderepo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v(" \n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("visibility")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" private\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("description")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" coderepo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v(" \n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nautes.resource.nautes.io/v1alpha1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" DeploymentRuntime\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" dr"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("destination")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" env"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("manifestsource")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("codeRepo")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" coderepo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" deployments\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targetRevision")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" main\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("product")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("projectsRef")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" project"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0412")]),t._v("\n")])])]),e("ol",{attrs:{start:"3"}},[e("li",[t._v("Download the "),e("a",{attrs:{href:"https://github.com/nautes-labs/cli/releases/tag/v0.2.0",target:"_blank",rel:"noopener noreferrer"}},[t._v("command-line tool"),e("OutboundLink")],1),t._v(" and run the following command to prepare the runtime environment.")])]),t._v(" "),e("div",{staticClass:"language-Shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# examples/demo-product.yaml refers to the relative path of the template file in the command-line repository.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# gitlab-access-token refers to the GitLab access token.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# api-server-address refers to the access address of the Nautes API Server.")]),t._v("\nnautes apply "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" examples/demo-product.yaml "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$gitlab")]),t._v("-access-token "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$api")]),t._v("-server-address\n")])])]),e("h2",{attrs:{id:"deployment"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#deployment"}},[t._v("#")]),t._v(" Deployment")]),t._v(" "),e("p",[t._v("Submit the Kubernetes Manifests to the product's code repository, such as deployment, service, and other resources.")]),t._v(" "),e("ol",[e("li",[t._v("Clone the sample example repository to your local machine.")])]),t._v(" "),e("div",{staticClass:"language-Shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/lanbingcloud/demo-user-deployments.git\n")])])]),e("ol",{attrs:{start:"2"}},[e("li",[t._v("Modify the domain name of the Ingress resource in the local code repository: "),e("code",[t._v("/deployment/test/devops-sample-svc.yaml")])])]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" networking.k8s.io/v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Ingress\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("sample"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("dev\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rules")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Replace $cluster-ip with the public IP of the runtime cluster.")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("host")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" devops"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("sample.$cluster"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("ip.nip.io\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("http")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("paths")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n")])])]),e("ol",{attrs:{start:"3"}},[e("li",[e("p",[t._v("Access "),e("RouterLink",{attrs:{to:"/en/guide/user-guide/installation.html#check-the-installation-results"}},[t._v("GitLab")]),t._v(" and configure the GitLab account to have permission for force-push code to the main branch. For more information, refer to "),e("a",{attrs:{href:"https://docs.gitlab.com/ee/user/project/protected_branches.html#allow-force-push-on-a-protected-branch",target:"_blank",rel:"noopener noreferrer"}},[t._v("Allow Force Push to a Protected Branch"),e("OutboundLink")],1),t._v(".")],1)]),t._v(" "),e("li",[e("p",[t._v("Push the Kubernetes Manifests to the product's code repository.")])])]),t._v(" "),e("div",{staticClass:"language-Shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Replace the variable $deployment-manifest-repo with the code repository storing the Kubernetes Manifests.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" remote set-url origin "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$deployment")]),t._v("-manifest-repo\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Push the Kubernetes Manifests to the product's code repository.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-m")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'submit the kubernetes manifests.'")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push origin main "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v("\n")])])]),e("h2",{attrs:{id:"view-deployment-results"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#view-deployment-results"}},[t._v("#")]),t._v(" View Deployment Results")]),t._v(" "),e("p",[t._v("After the deployment is successful, you will be able to access the UI of the sample application by using a browser to access "),e("code",[t._v("http://devops-sample.$cluster-ip.nip.io:$traefik-httpnodeport")]),t._v(".")]),t._v(" "),e("blockquote",[e("p",[t._v("Replace the $cluster-ip variable with the public IP of the cluster hosting the runtime environment.")]),t._v(" "),e("p",[t._v("Replace the $traefik-httpnodeport variable with the traefik port of the cluster hosting the runtime environment. For more information, refer to "),e("code",[t._v("spec.traefik.httpNodePort")]),t._v(" in the property template in the "),e("a",{attrs:{href:"#register-physical-cluster"}},[t._v("Register Physical Cluster")]),t._v(" or "),e("a",{attrs:{href:"#register-virtual-cluster"}},[t._v("Register Virtual Cluster")]),t._v(" section, for example, "),e("code",[t._v("30080")]),t._v(".")])]),t._v(" "),e("p",[t._v("Through the ArgoCD console, you will be able to view the deployment results of the application and manage resources related to authorized products only.")]),t._v(" "),e("p",[t._v("Access the ArgoCD console installed on the runtime cluster by using a browser to access "),e("code",[t._v("https://$argocdHost:$traefik-httpsNodePort")]),t._v(". Click "),e("code",[t._v("LOG IN VIA DEX")]),t._v(" for unified authentication. If you haven't logged into GitLab in the current browser session, you'll need to enter your GitLab account and password to log in. After logging in successfully, the page will automatically redirect to the ArgoCD console.")]),t._v(" "),e("blockquote",[e("p",[t._v("Replace the $argocdHost variable with the argocdHost address of the cluster hosting the runtime environment. For more information, refer to "),e("code",[t._v("spec.argocdHost")]),t._v(" in the property template in the "),e("a",{attrs:{href:"#register-physical-cluster"}},[t._v("Register Physical Cluster")]),t._v(" or "),e("a",{attrs:{href:"#register-virtual-cluster"}},[t._v("Register Virtual Cluster")]),t._v(" section, for example, "),e("code",[t._v("argocd.vcluster-aliyun-0412.8.217.50.114.nip.io")]),t._v(".")]),t._v(" "),e("p",[t._v("Replace the $traefik-httpsNodePort variable with the traefik port of the cluster hosting the runtime environment. For more information, refer to "),e("code",[t._v("spec.traefik.httpsNodePort")]),t._v(" in the property template in the "),e("a",{attrs:{href:"#register-physical-cluster"}},[t._v("Register Physical Cluster")]),t._v(" or "),e("a",{attrs:{href:"#register-virtual-cluster"}},[t._v("Register Virtual Cluster")]),t._v(" section, for example, "),e("code",[t._v("30443")]),t._v(".")])]),t._v(" "),e("p",[t._v('The ArgoCD console lists ArgoCD applications related to products authorized for you, and you will be able to view and manage related resources. By clicking on an ArgoCD application card, you can see the resource manifest, YAML, events, logs, and perform actions such as synchronize, restart, and delete. By clicking on "Settings" in the left menu bar of the ArgoCD console, you can also view ArgoCD projects related to authorized products.')])])}),[],!1,null,null,null);e.default=n.exports}}]);