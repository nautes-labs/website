(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{335:function(a,t,s){"use strict";s.r(t);var e=s(14),n=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"维护环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#维护环境"}},[a._v("#")]),a._v(" 维护环境")]),a._v(" "),t("p",[a._v("在开始本节之前，请确保您已阅读 "),t("RouterLink",{attrs:{to:"/guide/user-guide/main-process.html"}},[a._v("主体流程")]),a._v(" 章节，了解执行流水线和部署应用的主体流程和相关术语。")],1),a._v(" "),t("p",[a._v("环境是使用集群（目前只支持 Kubernetes集群）来承载产品中各个项目的集成和部署的管理单元。一个产品包含多个环境，如：开发环境、测试环境、预生产环境和生产环境等。")]),a._v(" "),t("p",[a._v("支持通过 "),t("RouterLink",{attrs:{to:"/guide/user-guide/deploy-an-application.html#初始化产品"}},[a._v("命令行")]),a._v(" 和 API 两种方式维护环境。")],1),a._v(" "),t("h2",{attrs:{id:"前提条件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前提条件"}},[a._v("#")]),a._v(" 前提条件")]),a._v(" "),t("h3",{attrs:{id:"创建-access-token"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建-access-token"}},[a._v("#")]),a._v(" 创建 access token")]),a._v(" "),t("p",[a._v("您需要创建一个 access token，作为请求 API 的请求头。详情参考 "),t("RouterLink",{attrs:{to:"/guide/user-guide/product.html#创建-access-token"}},[a._v("创建 access token")]),a._v("。")],1),a._v(" "),t("h3",{attrs:{id:"导入证书"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#导入证书"}},[a._v("#")]),a._v(" 导入证书")]),a._v(" "),t("p",[a._v("在使用 HTTPS 协议访问 Nautes API Server 之前，请先"),t("RouterLink",{attrs:{to:"/guide/user-guide/run-a-pipeline.html#导入证书"}},[a._v("导入证书")]),a._v("。")],1),a._v(" "),t("h3",{attrs:{id:"创建产品"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建产品"}},[a._v("#")]),a._v(" 创建产品")]),a._v(" "),t("p",[a._v("环境归属于产品，您需要创建至少一个"),t("RouterLink",{attrs:{to:"/guide/user-guide/product.html#创建产品api"}},[a._v("产品")]),a._v("。")],1),a._v(" "),t("h3",{attrs:{id:"注册运行时集群"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#注册运行时集群"}},[a._v("#")]),a._v(" 注册运行时集群")]),a._v(" "),t("p",[a._v("环境需要与运行时集群关联，您需要注册至少一个"),t("RouterLink",{attrs:{to:"/guide/user-guide/cluster.html#注册物理集群api"}},[a._v("物理运行时集群")]),a._v("或者一个"),t("RouterLink",{attrs:{to:"/guide/user-guide/cluster.html#注册虚拟集群api"}},[a._v("虚拟运行时集群")]),a._v("。")],1),a._v(" "),t("h2",{attrs:{id:"创建和更新环境-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建和更新环境-api"}},[a._v("#")]),a._v(" 创建和更新环境（API）")]),a._v(" "),t("h3",{attrs:{id:"生成创建-更新环境的-api-请求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生成创建-更新环境的-api-请求"}},[a._v("#")]),a._v(" 生成创建/更新环境的 API 请求")]),a._v(" "),t("p",[a._v("通过接口定义 "),t("code",[a._v("Environment_SaveEnvironment")]),a._v(" 生成 API 请求示例，并添加 access token 作为请求头。")]),a._v(" "),t("div",{staticClass:"language-Shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 替换变量 $api-server-address 为 Nautes API Server 的访问地址")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 替换变量 $gitlab-access-token 为 GitLab access token")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 替换变量 $product-name 为环境所属产品的名称")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 替换变量 $environment-name 为环境名称")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-X")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'POST'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'HTTP://$api-server-address/api/v1/products/$product-name/environments/$environment-name'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'accept: application/json'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Content-Type: application/json'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Authorization: Bearer $gitlab-access-token'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('\'{\n                # 环境关联的运行时集群\n                "cluster": $cluster-name,\n                # 环境类型\n                "env_type": $env-type\n            }\'')]),a._v("\n")])])]),t("p",[a._v("替换变量后的请求示例如下：")]),a._v(" "),t("div",{staticClass:"language-Shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("    "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-X")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'POST'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'HTTP://xxx.xxx.xxx.xxx:xxxxx/api/v1/products/nautes-labs/environments/env-dev'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'accept: application/json'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Content-Type: application/json'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Authorization: Bearer xxxxxxxxxxxxxxxxxxxx'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('\'{\n                "cluster": "cluster-dev",\n                "env_type": "development"\n            }\'')]),a._v("\n")])])]),t("h3",{attrs:{id:"执行创建-更新环境的-api-请求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#执行创建-更新环境的-api-请求"}},[a._v("#")]),a._v(" 执行创建/更新环境的 API 请求")]),a._v(" "),t("p",[a._v("使用 curl 命令或者其他工具执行 API 请求，以新增环境。\n请求成功后，将在指定产品的 "),t("code",[a._v("default.project")]),a._v(" 代码库中生成环境的资源文件。环境的资源文件示例如下：")]),a._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[a._v("    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" nautes.resource.nautes.io/v1alpha1\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" Environment\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("dev\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cluster")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" cluster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("dev\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("envType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" development\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("product")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("xxxx\n")])])]),t("blockquote",[t("p",[a._v("相同产品内，相同的运行时集群不能重复关联不同的环境。")]),a._v(" "),t("p",[a._v("当环境已经承载了产品的运行时，暂不支持变更环境的关联集群。")]),a._v(" "),t("p",[a._v("请求 API 更新环境也将更新环境的资源文件。")]),a._v(" "),t("p",[a._v("只有当您的账号是 GitLab 的 group 成员，并且具备对 "),t("code",[a._v("default.project")]),a._v(" 代码库的 main 分支的写入权限，才可以创建或者更新环境。")])]),a._v(" "),t("h2",{attrs:{id:"删除环境-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除环境-api"}},[a._v("#")]),a._v(" 删除环境（API）")]),a._v(" "),t("blockquote",[t("p",[a._v("在删除环境之前，请先删除与环境关联的所有相关实体和资源，例如：流水线运行时和部署运行时，否则将不能执行删除。")])]),a._v(" "),t("h3",{attrs:{id:"生成删除环境的-api-请求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生成删除环境的-api-请求"}},[a._v("#")]),a._v(" 生成删除环境的 API 请求")]),a._v(" "),t("p",[a._v("通过接口定义 "),t("code",[a._v("Environment_DeleteEnvironment")]),a._v(" 生成 API 请求示例，并添加 access token 作为请求头。")]),a._v(" "),t("div",{staticClass:"language-Shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("    "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-X")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'DELETE'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'HTTP://$api-server-address/api/v1/products/$product-name/environments/$environment-name'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'accept: application/json'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Authorization: Bearer $gitlab-access-token'")]),a._v("\n")])])]),t("p",[a._v("替换变量后的请求示例如下：")]),a._v(" "),t("div",{staticClass:"language-Shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("    "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-X")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'DELETE'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'HTTP://xxx.xxx.xxx.xxx:xxxxx/api/v1/products/nautes-labs/environments/env-dev'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'accept: application/json'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Authorization: Bearer xxxxxxxxxxxxxxxxxxxx'")]),a._v("\n")])])]),t("h3",{attrs:{id:"执行删除环境的-api-请求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#执行删除环境的-api-请求"}},[a._v("#")]),a._v(" 执行删除环境的 API 请求")]),a._v(" "),t("p",[a._v("使用 curl 命令或者其他工具执行 API 请求，以删除环境。")]),a._v(" "),t("p",[a._v("请求成功后，将删除在指定产品的 "),t("code",[a._v("default.project")]),a._v(" 代码库中的环境资源文件。")]),a._v(" "),t("blockquote",[t("p",[a._v("只有当您的账号是 GitLab 的 group 成员，并且具备对 "),t("code",[a._v("default.project")]),a._v(" 代码库的 main 分支的写入权限，才可以删除环境。")])]),a._v(" "),t("h2",{attrs:{id:"查询环境列表-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查询环境列表-api"}},[a._v("#")]),a._v(" 查询环境列表（API）")]),a._v(" "),t("h3",{attrs:{id:"生成查询环境列表的-api-请求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生成查询环境列表的-api-请求"}},[a._v("#")]),a._v(" 生成查询环境列表的 API 请求")]),a._v(" "),t("p",[a._v("通过接口定义 "),t("code",[a._v("Environment_ListEnvironments")]),a._v(" 生成 API 请求示例，并添加 access token 作为请求头。")]),a._v(" "),t("div",{staticClass:"language-Shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("    "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-X")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'GET'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'HTTP://$api-server-address/api/v1/products/$product-name/environments'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'accept: application/json'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Authorization: Bearer $gitlab-access-token'")]),a._v("\n")])])]),t("p",[a._v("替换变量后的请求示例如下：")]),a._v(" "),t("div",{staticClass:"language-Shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("    "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-X")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'GET'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'HTTP://xxx.xxx.xxx.xxx:xxxxx/api/v1/products/nautes-labs/environments'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'accept: application/json'")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Authorization: Bearer xxxxxxxxxxxxxxxxxxxx'")]),a._v("\n")])])]),t("h3",{attrs:{id:"执行查询环境列表的-api-请求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#执行查询环境列表的-api-请求"}},[a._v("#")]),a._v(" 执行查询环境列表的 API 请求")]),a._v(" "),t("p",[a._v("使用 curl 命令或者其他工具执行 API 请求，以查询环境列表。环境列表的返回值示例如下：")]),a._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v('"items"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v('"product"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"nautes-labs"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v('"name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"env-dev"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v('"cluster"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"cluster-dev"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v('"env_type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"development"')]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("blockquote",[t("p",[a._v("只有当您的账号是 GitLab 的 group 成员，并且具备对 "),t("code",[a._v("default.project")]),a._v(" 代码库的读取权限，才可以查询环境列表。")])]),a._v(" "),t("h2",{attrs:{id:"查询环境详情-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查询环境详情-api"}},[a._v("#")]),a._v(" 查询环境详情（API）")]),a._v(" "),t("h3",{attrs:{id:"生成查看环境详情的-api-请求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生成查看环境详情的-api-请求"}},[a._v("#")]),a._v(" 生成查看环境详情的 API 请求")]),a._v(" "),t("p",[a._v("通过接口定义 "),t("code",[a._v("Environment_GetEnvironment")]),a._v(" 生成 API 请求示例，并添加 access token 作为请求头。")]),a._v(" "),t("div",{staticClass:"language-Shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("    "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-X")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'GET'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'HTTP://$api-server-address/api/v1/products/$product-name/environments/$enviroment-name'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'accept: application/json'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Authorization: Bearer $gitlab-access-token'")]),a._v("\n")])])]),t("p",[a._v("替换变量后的请求示例如下：")]),a._v(" "),t("div",{staticClass:"language-Shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("    "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-X")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'GET'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'HTTP://xxx.xxx.xxx.xxx:xxxxx/api/v1/products/nautes-labs/environments/env-dev'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'accept: application/json'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Authorization: Bearer xxxxxxxxxxxxxxxxxxxx'")]),a._v("\n")])])]),t("h3",{attrs:{id:"执行查看环境详情的-api-请求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#执行查看环境详情的-api-请求"}},[a._v("#")]),a._v(" 执行查看环境详情的 API 请求")]),a._v(" "),t("p",[a._v("使用 curl 命令或者其他工具执行 API 请求，以查询环境详情。环境详情的返回值示例与"),t("a",{attrs:{href:"#%E6%89%A7%E8%A1%8C%E6%9F%A5%E8%AF%A2%E7%8E%AF%E5%A2%83%E5%88%97%E8%A1%A8%E7%9A%84-api-%E8%AF%B7%E6%B1%82"}},[a._v("查询环境列表")]),a._v("类似。")]),a._v(" "),t("blockquote",[t("p",[a._v("只有当您的账号是 GitLab 的 group 成员，并且具备对 "),t("code",[a._v("default.project")]),a._v(" 代码库的读取权限，才可以查看环境详情。")])]),a._v(" "),t("h2",{attrs:{id:"强制创建-更新-删除环境-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#强制创建-更新-删除环境-api"}},[a._v("#")]),a._v(" 强制创建/更新/删除环境（API）")]),a._v(" "),t("p",[a._v("适用于需要跳过 API 校验的特殊场景，详情参见"),t("RouterLink",{attrs:{to:"/guide/user-guide/main-process.html#初始化产品"}},[a._v("初始化产品")]),a._v("。")],1),a._v(" "),t("p",[a._v("以创建环境为例，将 cluster 属性设置为不存在的 cluster，启用 "),t("code",[a._v("insecure_skip_check")]),a._v(" 查询参数并设置其值为 "),t("code",[a._v("true")]),a._v("，可以强制提交环境的资源文件。 请求示例如下：")]),a._v(" "),t("div",{staticClass:"language-Shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("    "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-X")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'POST'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'HTTP://xxx.xxx.xxx.xxx:xxxxx/api/v1/products/nautes-labs/environments/env-demo?insecure_skip_check=true'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'accept: application/json'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Content-Type: application/json'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('\'{\n                "cluster": "cluster-invalid",\n                "env_type": "development"\n            }\'')]),a._v("\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);